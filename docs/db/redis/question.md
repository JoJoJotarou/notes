# 分布式、高并发下缓存失效

## 缓存穿透

当查询redis 为命中时（例如查询数据库中不存在数据），所有的请求都会转给数据库，当请求量非常大时，会造成数据库性能下架甚至崩溃。

![缓存穿透](https://www.javazhiyin.com/wp-content/uploads/2020/11/java5-1605595509.png)

**解决办法**：给数据库中不存在的数据也存入redis，值设置为 null ，并设置合适的过期时间，这样只有在过期之后才会再一次请求数据库。

## 缓存雪崩

大面积 Key 同时失效，大量请求转给数据库，数据库瞬时压力过大导致崩溃。

**解决办法**：给 Key 设置随机过期时间，降低过期时间重复率，这样就能降低雪崩发生的改了。

## 缓存击穿

”热点“数据设置缓存过期时间，在过期时出现大量请求，直接访问数据库，这叫缓存击穿。

**解决办法**：加锁

### 分布式锁
